WEBVTT

00:00:00.000 --> 00:00:04.160
Fun With Rails and High-Performance Caching Mechanisms (Memcached)

00:00:05.660 --> 00:00:08.220
Published on February 27, 2008.

00:00:09.220 --> 00:00:18.180
Since it’s Spring break for University of Michiganers, I’ve had some free time to mess around with learning stuff I don’t have time for when school is in session.

00:00:18.680 --> 00:00:27.640
Something I’ve been meaning to try out is memcached, which is an uber-efficient way to cache stuff in memory so you don’t end up hitting the database a lot for redundant queries.

00:00:28.640 --> 00:00:35.120
I installed memcached on my mediatemple machine using some directions I found online specifically for centos.

00:00:35.620 --> 00:00:40.740
I don’t have yum or rpm or whatever people use for putting new stuff onto their linux boxes.

00:00:41.240 --> 00:00:45.400
I just wget, untar, and make/make install.

00:00:45.900 --> 00:00:52.060
I had to make a symbolic link for the libevent thing that I installed as well since the path wasn’t set up correctly.

00:00:52.560 --> 00:00:56.880
I’m still trying to get memcached to run automatically as a daemon when I boot up.

00:00:57.380 --> 00:01:04.500
I tried sticking a line in the /etc/init.d/ or something rc.local but it hasn’t really worked. Oh well.

00:01:05.500 --> 00:01:12.620
I’m using memcached right now along with a rails gem called “Cached Model” that does a pretty good job of automating the caching process.

00:01:13.120 --> 00:01:19.120
What’s important to know is that the gem only caches Active Records that are found via a simple find on id.

00:01:19.620 --> 00:01:22.500
It won’t cache more complex queries.

00:01:23.000 --> 00:01:26.840
Right now I have it running on my Animenano site caching a bunch of objects.

00:01:27.340 --> 00:01:30.140
I’ve seen a small though noticeable difference.

00:01:31.140 --> 00:01:33.940
Memcached isn’t without its caveats, however.

00:01:34.440 --> 00:01:43.960
For one thing, your initial db hit is going to take longer than normal since you’re going to be checking memcached, then grabbing the data from the db, then saving the data into memory.

00:01:44.460 --> 00:01:47.900
From reading the logs, this doesn’t really take that much extra time.

00:01:48.400 --> 00:01:51.360
The time saved is likely more worthwhile.

00:01:52.360 --> 00:01:55.240
I’m always trying to squeeze more performance out of my sites.

00:01:55.740 --> 00:02:02.860
Periodically I’ll go check out my log files and see if there’s anything taking an insane amount of time to render (like, .1 seconds or so).

00:02:03.360 --> 00:02:10.000
I’ve caught a few bad algorithm decisions that I had made in the past, and I think for the most part my sites run pretty efficiently.

00:02:10.500 --> 00:02:16.180
Memcached is a pretty fun way to slice some time off of the page rendering times for Anime Nano.

00:02:17.180 --> 00:02:26.940
If you have a few spare hours to kill and a rails app that seems to be a little slow, it might be worthwhile to install memcached and see if caching your Active Record objects will speed things up.

00:02:27.440 --> 00:02:34.320
I’m seeing a speedup of maybe 1/2 (it takes half as long to load a page) vs running without memcached.

00:02:34.820 --> 00:02:37.380
That’s totally non-empirical observation, though.
