WEBVTT

00:00:00.000 --> 00:00:01.998
Side Project: Audubon

00:00:03.498 --> 00:00:06.055
Published on March 10, 2015.

00:00:07.055 --> 00:00:07.694
The Idea

00:00:09.194 --> 00:00:15.747
A few weeks ago, I noticed a tweet from John Sheehan asking if there was an automated tweet -> screenshot tool:

00:00:16.747 --> 00:00:24.259
I thought it was a pretty interesting concept that would be fairly easy to implement and had a small enough scope that I could use it to learn some more Javascript.

00:00:24.759 --> 00:00:30.433
After playing around with Ghost Inspector , I knew it would be possible to render a screen capture of a webpage.

00:00:30.933 --> 00:00:37.246
I just needed to implement the logic for figuring out what area of a page to render, rather than the whole page.

00:00:38.246 --> 00:00:39.045
The Solution

00:00:40.545 --> 00:00:49.975
I played around with CasperJS before finding a StackOverflow post that described that I could do all that I wanted in PhantomJS , which CasperJS is built on.

00:00:50.475 --> 00:00:55.909
I wrote a script that would take a url as an input and spit a png out to stdout.

00:00:56.409 --> 00:01:04.640
Then I wrote a node web app in Express that could take the url as a parameter and run the script through the child_process.spawn command.

00:01:05.140 --> 00:01:12.333
I had the express app write the stdout of the child process to a buffer and send it once the script was finished. Done!

00:01:13.333 --> 00:01:13.972
Heroku

00:01:15.472 --> 00:01:19.148
I ran into a problem when I wanted to host my app on Heroku.

00:01:19.648 --> 00:01:28.838
Heroku apparently does not support writing to /dev/stdout, and I only found out about this when my images were being sent as empty files.

00:01:29.338 --> 00:01:38.049
I looked at some solutions that involved writing to an Amazon S3 bucket, but I didn’t want to incur that much of an operations overhead for something so lightweight.

00:01:39.049 --> 00:01:48.000
As a workaround, I found that Heroku does allow writing to /tmp, though any files you throw in there are not guaranteed to remain there after the request is over.

00:01:48.500 --> 00:01:53.055
For me that’s perfect, since the file only needs to exist as long as the request lasts.

00:01:54.055 --> 00:02:03.644
Finally, I threw together an index view with a form and a button that takes a Twitter URL and loads the image into the same view when you click on “OK.”

00:02:04.144 --> 00:02:07.980
I got a nice theme from here and hardly customized it.

00:02:08.980 --> 00:02:14.654
I also figured out how to use the “Deploy to Heroku” feature by adding an app.json file to my git project.

00:02:15.654 --> 00:02:27.802
There were a couple of other issues I ran into that I didn’t describe yet, mostly getting PhantomJS 2.0 to run on Heroku (because previous versions don’t render webfonts correctly) and setting up the multiple buildpacks on Heroku.

00:02:28.302 --> 00:02:31.898
You can see what I ended up using by inspecting the Github project here .

00:02:32.898 --> 00:02:39.371
I called the project Audubon after the Audubon Society which is really into birds (get it? birds, tweets?).

00:02:39.871 --> 00:02:42.188
You can deploy it yourself with this button:

00:02:43.188 --> 00:02:43.747
TODO

00:02:45.247 --> 00:02:48.284
There’s a couple of things I need to wrap up in this project.

00:02:48.784 --> 00:02:54.857
If anyone wants to they could also fork the project and throw a pull request at me, but I’m planning on doing these eventually:

00:02:55.857 --> 00:03:02.490
Make the command line tool better for generating images (right now it just writes to /tmp so I should make that configurable).

00:03:03.490 --> 00:03:07.326
Make a bookmarklet so it’s easy to create images from the Twitter website.

00:03:08.326 --> 00:03:11.043
Make the web index page look a little nicer

00:03:12.043 --> 00:03:15.159
Maybe provide image format and quality options

00:03:16.159 --> 00:03:20.874
Overall I think this was a really good side project in terms of scope and complete-ability.

00:03:21.374 --> 00:03:25.450
I learned a lot about Node.js, ExpressJS and PhantomJS.

00:03:25.950 --> 00:03:31.224
I’ve been meaning to level up my Javascript web game, and this project has been a useful exercise.
